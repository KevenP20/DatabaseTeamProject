//question 1 part5
SELECT COUNT(order_id) AS totalOrder, sum(tax_amount) AS totalTax
FROM orders
//question 2 part5
SELECT category_name, COUNT(*) AS ProductCount,
MAX(list_price) AS MostExpensiveProductPrice
FROM categories c JOIN products p
ON c.category_id = p.category_id
GROUP BY category_name
ORDER BY ProductCount DESC
//question 3 part5
SELECT email_address, SUM(item_price * quantity) AS TotalPrice,
SUM(discount_amount * quantity) AS TotalDiscount
FROM Customers c
JOIN Orders o ON c.customer_id = o.customer_id
JOIN order_items oi ON o.order_id = oi.order_id
GROUP BY email_address
ORDER BY TotalPrice DESC
//question 4 part5
SELECT email_address, COUNT(o.order_id) AS OrderCount,
SUM((item_price - discount_amount) * quantity) AS OrderTotal
FROM customers c
JOIN orders o ON c.customer_id = o.customer_id
JOIN order_items oi ON o.order_id = oi.order_id
GROUP BY email_address
HAVING COUNT(o.order_id) > 1
ORDER BY OrderTotal DESC
//question 5 part5
SELECT email_address, COUNT(o.order_id) AS OrderCount,
SUM((item_price - discount_amount) * quantity) AS OrderTotal
FROM customers c
JOIN orders o ON c.customer_id = o.customer_id
JOIN order_items oi ON o.order_id = oi.order_id
WHERE item_price > 400
GROUP BY email_address
HAVING COUNT(o.order_id) > 1
ORDER BY OrderTotal DESC
//question 6 part5
SELECT product_name, SUM((item_price - discount_amount) * quantity) AS ProductTotal
FROM products p
JOIN order_items oi ON p.product_id = oi.product_id
GROUP BY product_name WITH ROLLUP
//question 7 part5
SELECT email_address, COUNT(DISTINCT oi.product_id) AS numOfProducts
FROM customers c
JOIN orders o ON c.customer_id = o.customer_id
JOIN order_items oi ON o.order_id = oi.order_id
GROUP BY email_address
HAVING COUNT(DISTINCT oi.product_id) > 1
ORDER BY email_address
//question 8 part5
SELECT category_name, product_name, SUM(quantity) AS TotalQuantity
FROM categories c
JOIN products p ON c.category_id = p.category_id
JOIN order_items oi ON p.product_id = oi.product_id
GROUP BY category_name WITH ROLLUP //incomplete still needs to change null values to literal values
